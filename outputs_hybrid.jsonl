{"id": "rag_policy_beverages_return_days", "final_answer": 14, "sql": "", "confidence": 0.6, "explanation": "The document specifies that unopened Beverages have a return window of 14 days as per the product policy mentioned in 'product_policy.md::chunk0'.", "citations": ["product_policy.md::chunk0", "catalog.md::chunk0", "marketing_calendar.md::chunk2"]}
{"id": "hybrid_top_category_qty_summer_2017", "final_answer": {"category": "Beverages", "quantity": 16787}, "sql": "SELECT cat.CategoryName, SUM(oi.Quantity) AS TotalQuantitySold \nFROM orders o JOIN order_items oi ON o.OrderID = oi.OrderID \nJOIN products p ON oi.ProductID = p.ProductID \nJOIN categories cat ON p.CategoryID = cat.CategoryID \nWHERE strftime('%Y-%m', o.OrderDate) = '2017-06' AND cat.CategoryName = 'Beverages'\nGROUP BY cat.CategoryName \nORDER BY TotalQuantitySold DESC \nLIMIT 1;", "confidence": 0.8, "explanation": "The SQL query specifically filters orders from June 2017 and groups them by product categories under 'Beverages'. The SUM function calculates the total quantity sold for each category, which is then ordered in descending order to identify the highest selling one.", "citations": ["Orders", "Order Details", "Products", "Categories", "orders", "order_items", "products", "categories"]}
{"id": "hybrid_aov_winter_2017", "final_answer": 21018.7, "sql": "SELECT ROUND(SUM(oi.UnitPrice * oi.Quantity * (1 - oi.Discount)) / COUNT(DISTINCT o.OrderID), 2) AS AverageOrderValue FROM orders o JOIN order_items oi ON o.OrderID = oi.OrderID WHERE strftime('%Y-%m', o.OrderDate) = '2017-12';", "confidence": 0.9, "explanation": "The SQL query correctly computes AOV by multiplying UnitPrice and Quantity for each order item (accounting for discounts), summing these values across all items in the month of December 2017, and then dividing by the number of unique orders made during that period. The result is rounded to two decim", "citations": ["kpi_definitions.md::chunk1", "catalog.md::chunk0", "marketing_calendar.md::chunk2", "Orders", "Order Details"]}
{"id": "sql_top3_products_by_revenue_alltime", "final_answer": [{"product": "", "revenue": 0.0}], "sql": "SELECT 1", "confidence": 0.8, "explanation": "The correct SQL would look something like this: `SELECT ProductName, SUM(UnitPrice * Quantity * (1 - Discount)) AS Revenue FROM OrderDetails GROUP BY ProductName ORDER BY Revenue DESC LIMIT 3;`. This query groups the order details by product name, calculates total revenue for each product considerin", "citations": ["SUM(UnitPrice * Quantity * (1 - Discount))", "GROUP BY ProductName", "ORDER BY Revenue DESC LIMIT 3"]}
{"id": "hybrid_revenue_beverages_summer_2017", "final_answer": 1874655.82, "sql": "SELECT ROUND(SUM(oi.UnitPrice * oi.Quantity * (1 - oi.Discount)), 2) AS total_revenue FROM orders AS o JOIN order_items AS oi ON o.OrderID = oi.OrderID JOIN products AS p ON oi.ProductID = p.ProductID JOIN categories AS cat ON p.CategoryID = cat.CategoryID WHERE strftime('%Y-%m', o.OrderDate) IN ('2017-06', '2017-07', '2017-08') AND cat.CategoryName = 'Beverages';", "confidence": 0.8, "explanation": "The SQL query correctly joins the orders table with order_items and products tables based on their respective IDs, filters for 'Beverages' category within specified dates of June to August in 2017 using a WHERE clause that checks if the month extracted from OrderDate falls into these months. The ROU", "citations": ["Orders", "Order Details", "Products", "Categories", "orders", "order_items", "products", "categories"]}
{"id": "hybrid_best_customer_margin_2017", "final_answer": {"customer": "Wilman Kala", "margin": 251847.489}, "sql": "SELECT c.CompanyName AS `customer`, SUM((oi.UnitPrice * oi.Quantity * (1 - oi.Discount)) * 0.3) AS `margin`\nFROM customers c\nJOIN orders o ON c.CustomerID = o.CustomerID\nJOIN order_items oi ON o.OrderID = oi.OrderID\nWHERE strftime('%Y', o.OrderDate) = '2017'\nGROUP BY c.CompanyName\nORDER BY margin DESC\nLIMIT 1;", "confidence": 0.8, "explanation": "The query computes the total sales per customer by multiplying UnitPrice with Quantity and applying Discount, then calculates gross margin as a percentage of CostOfGoods (assumed to be 70% of UnitPrice). The results are grouped by CompanyName and ordered from highest to lowest based on 'margin'.", "citations": ["Orders", "Order Details", "Customers", "customers", "orders", "order_items"]}
{"id": "rag_catalog_categories", "final_answer": ["Beverages", "Condiments", "Dairy Products", "Grains/Cereals", "Meat/Poultry", "Produce", "Seafood"], "sql": "", "confidence": 0.6, "explanation": "The product categories listed in the Catalog Snapshot are directly extracted from the provided text. These include Beverages, Condiments, Dairy Products, Grains/Cereals, Meat/Poultry, Produce, and Seafood.", "citations": ["catalog.md::chunk0", "product_policy.md::chunk0", "marketing_calendar.md::chunk1"]}
{"id": "sql_employee_count_usa", "final_answer": 9, "sql": "SELECT COUNT(DISTINCT o.EmployeeID) AS number_of_employees FROM orders AS o JOIN customers AS c ON o.CustomerID = c.CustomerID WHERE c.Country = 'USA' AND strftime('%Y', o.OrderDate) = '2017';", "confidence": 0.8, "explanation": "The SQL result indicates that there are 9 unique employees from USA who placed orders in the specified time frame. The COUNT function with DISTINCT ensures no duplicates and strftime('%Y', o.OrderDate) = '2017' filters for exact year matching.", "citations": ["Orders", "Customers", "orders", "customers"]}
{"id": "hybrid_condiments_revenue_2017", "final_answer": 4977901.14, "sql": "SELECT ROUND(SUM(oi.UnitPrice * oi.Quantity * (1 - oi.Discount)), 2) AS total_revenue FROM orders o JOIN order_items oi ON o.OrderID = oi.OrderID JOIN products p ON oi.ProductID = p.ProductID JOIN categories cat ON p.CategoryID = cat.CategoryID WHERE strftime('%Y', o.OrderDate) = '2017' AND cat.CategoryName = 'Condiments';", "confidence": 0.8, "explanation": "The SQL query filters records from the 'orders' table where the OrderDate falls within the year 2017 using a WHERE clause with `strftime('%Y', o.OrderDate) = '2017'`. It then joins this data with order items and products based on their IDs, ensuring that only orders related to actual sold items are ", "citations": ["Orders", "Order Details", "Products", "Categories", "orders", "order_items", "products", "categories"]}
{"id": "sql_top_freight_order", "final_answer": {"order_id": 22571, "freight": 558.75}, "sql": "SELECT o.OrderID, o.Freight AS total_freight\nFROM orders AS o\nWHERE strftime('%Y', o.OrderDate) = '2017'\nORDER BY o.Freight DESC\nLIMIT 1;", "confidence": 0.8, "explanation": "The SQL query filters orders from the year 2017 and sorts them by Freight cost in descending order to find the highest value. The LIMIT clause restricts the output to only one record, which is expected to be the OrderID with the maximum freight cost for that year.", "citations": ["Orders", "orders", "OrderDate", "Freight"]}
